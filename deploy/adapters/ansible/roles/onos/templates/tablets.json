{
    "nodes": [
{% for host in groups['controller'] %}
    {% if loop.last %}
	    {
            "ip": "{{ hostvars[host]['ansible_' + INTERNAL_INTERFACE].ipv4.address }}",
            "id": "{{ hostvars[host]['ansible_' + INTERNAL_INTERFACE].ipv4.address }}",
            "tcpPort": 9876
        }
    {% else %}
        {
            "ip": "{{ hostvars[host]['ansible_' + INTERNAL_INTERFACE].ipv4.address }}",
            "id": "{{ hostvars[host]['ansible_' + INTERNAL_INTERFACE].ipv4.address }}",
            "tcpPort": 9876
        },
    {% endif %}
{% endfor %}
    ],
	"partitions": {
	{% set key = 1 %}
	{% for host in groups['controller'] %}
	{% if loop.last %}
	    "p{{ key }}":[
		{% for host in groups['controller'] %}
		    {% if loop.last %}
	    {
            "ip": "{{ hostvars[host]['ansible_' + INTERNAL_INTERFACE].ipv4.address }}",
            "id": "{{ hostvars[host]['ansible_' + INTERNAL_INTERFACE].ipv4.address }}",
            "tcpPort": 9876
        }
            {% else %}
        {
            "ip": "{{ hostvars[host]['ansible_' + INTERNAL_INTERFACE].ipv4.address }}",
            "id": "{{ hostvars[host]['ansible_' + INTERNAL_INTERFACE].ipv4.address }}",
            "tcpPort": 9876
        },
            {% endif %}
		{% endfor %}
		]
	{% set key = key + 1 %}
	{% else %}
	"p{{ key }}":[
		{% for host in groups['controller'] %}
		    {% if loop.last %}
	    {
            "ip": "{{ hostvars[host]['ansible_' + INTERNAL_INTERFACE].ipv4.address }}",
            "id": "{{ hostvars[host]['ansible_' + INTERNAL_INTERFACE].ipv4.address }}",
            "tcpPort": 9876
        }
            {% else %}
        {
            "ip": "{{ hostvars[host]['ansible_' + INTERNAL_INTERFACE].ipv4.address }}",
            "id": "{{ hostvars[host]['ansible_' + INTERNAL_INTERFACE].ipv4.address }}",
            "tcpPort": 9876
        },
            {% endif %}
		{% endfor %}
		],
	{% set key = key + 1 %}
	{% endif %}
	{% endfor %}
}
}
